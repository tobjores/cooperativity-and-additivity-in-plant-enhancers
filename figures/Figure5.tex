\begin{tikzpicture}
	\addtolength{\plotylabelwidth}{\baselineskip}
	
	%%% constructs
	\coordinate (constructs) at (0, 0);
	
	\coordinate[shift = {(.1, -.6)}] (del 1) at (constructs);
	
	\PSconstruct{del 1}{AB80!50}
	\draw[line width = .25cm, black] ($(c1)!.3!(c2)$) -- ++(.05, 0);
	\node[anchor = south, font = \bfseries, shift = {(-.45, .1)}] at (c2) {\textDelta 1};
	
	\coordinate[xshift = \columnsep] (del 2) at (construct end);
	
	\PSconstruct[MediumPurple1]{del 2}{AB80!50}
	\draw[line width = .25cm, black] ($(c1)!.5!(c2)$) -- ++(.05, 0);
	\node[anchor = south, font = \bfseries, shift = {(-.45, .1)}] at (c2) {\textDelta 2};
	
	\coordinate[xshift = \columnsep] (del 3) at (construct end);
	
	\PSconstruct[HotPink1]{del 3}{AB80!50}
	\draw[line width = .25cm, black] ($(c1)!.7!(c2)$) -- ++(.05, 0);
	\node[anchor = south, font = \bfseries, shift = {(-.45, .1)}] at (c2) {\textDelta 3};
	
	\node[anchor = west, font = \bfseries, align = center, xshift = \columnsep] at (construct end) {\textDelta4, \textDelta5,\\\textDelta6, \textDelta7,\\[-.5\baselineskip]\dots};
	
	\coordinate[yshift = -1cm] (double 12) at (del 1);
	
	\PSconstruct[MediumOrchid3]{double 12}{AB80!50}
	\draw[line width = .25cm, black] ($(c1)!.3!(c2)$) -- ++(.05, 0) ($(c1)!.5!(c2)$) -- ++(.05, 0);
	\node[anchor = south, font = \bfseries, shift = {(-.45, .1)}] at (c2) {\textDelta 1+\textDelta 2};
	
	\coordinate[yshift = -1cm] (double 13) at (del 2);
	
	\PSconstruct[Plum1]{double 13}{AB80!50}
	\draw[line width = .25cm, black] ($(c1)!.3!(c2)$) -- ++(.05, 0) ($(c1)!.7!(c2)$) -- ++(.05, 0);
	\node[anchor = south, font = \bfseries, shift = {(-.45, .1)}] at (c2) {\textDelta 1+\textDelta 3};
	
	\coordinate[yshift = -1cm] (double 23) at (del 3);
	
	\PSconstruct[SlateBlue3]{double 23}{AB80!50}
	\draw[line width = .25cm, black] ($(c1)!.5!(c2)$) -- ++(.05, 0) ($(c1)!.7!(c2)$) -- ++(.05, 0);
	\node[anchor = south, font = \bfseries, shift = {(-.45, .1)}] at (c2) {\textDelta 2+\textDelta 3};
	
	\node[anchor = west, font = \bfseries, align = center, xshift = \columnsep] at (construct end) {\textDelta1+\textDelta4,\\\textDelta2+\textDelta4,\\[-.5\baselineskip]\dots};
	
	
	%%% effect of two deletions in light
	\coordinate[yshift = -\columnsep] (prediction light) at (constructs |- ORF.south);
	
	\node[anchor = north west, text depth = 0pt, font = \hphantom{A}] (ptitle) at (prediction light) {\vphantom{\light}};
	
	\distance{ptitle.south}{ptitle.north}
	
	\pgfmathsetlength{\templength}{(\textwidth + \pgflinewidth - 2\plotylabelwidth - 2\groupplotsep - 2\ydistance - \columnsep) / 4}
	
	\begin{hgroupplot}[%
		group position = {anchor = above north west, at = {(prediction light)}, xshift = \plotylabelwidth},
		enlargelimits = .05,
		ylabel = \textbf{measurement}:\\$\log_2$(enhancer strength),
		zero line,
		show diagonal,
		colormap name = viridis,
		colorbar distance,
	]{3\templength + \plotylabelwidth + 2\groupplotsep}{3}{\textbf{additive model}: $\log_2$(enhancer strength)}
		
		\nextgroupplot[
			title = \enhancer{AB80} enhancer\\\segment{B} segment,
			title color = AB80,
			axis limits from table = {rawData/PEVdouble_prediction_AB80_light_axes.tsv}
		]
		
			% scatter plot
			\addplot [
				scatter,
				only marks,
				mark = solido,
				fill opacity = .5,
				point meta = explicit
			] table[x = prediction, y = enrichment, meta = distance] {rawData/PEVdouble_prediction_AB80_light_points.tsv};
			
			% correlation
			\stats[stats position = south east]{rawData/PEVdouble_prediction_AB80_light}
			
			
		\nextgroupplot[
			title = \enhancer{Cab-1} enhancer\\\segment{B} segment,
			title color = Cab-1,
			axis limits from table = {rawData/PEVdouble_prediction_Cab-1_light_axes.tsv}
		]
		
			% scatter plot
			\addplot [
				scatter,
				only marks,
				mark = solido,
				fill opacity = .5,
				point meta = explicit
			] table[x = prediction, y = enrichment, meta = distance] {rawData/PEVdouble_prediction_Cab-1_light_points.tsv};
			
			% correlation
			\stats[stats position = south east]{rawData/PEVdouble_prediction_Cab-1_light}
			
			
		\nextgroupplot[
			title = \enhancer{rbcS-E9} enhancer\\\segment{B} segment,
			title color = rbcS-E9,
			axis limits from table = {rawData/PEVdouble_prediction_rbcS-E9_light_axes.tsv}
		]
		
			% scatter plot
			\addplot [
				scatter,
				only marks,
				mark = solido,
				fill opacity = .5,
				point meta = explicit
			] table[x = prediction, y = enrichment, meta = distance] {rawData/PEVdouble_prediction_rbcS-E9_light_points.tsv};
			
			% correlation
			\stats[stats position = south east]{rawData/PEVdouble_prediction_rbcS-E9_light}
		
	\end{hgroupplot}
	
	\distance{group c3r1.south}{group c3r1.north}
	
	\node[anchor = south west, rotate = -90, draw = black, fill = light!20, minimum width = \ydistance, shift = {(-.5\pgflinewidth, -.5\pgflinewidth)}, text depth = 0pt, font = \hphantom{A}] (tlight) at (group c3r1.north east) {\light};
	
	
	%%% effect of two deletions in dark
	\coordinate[xshift = \columnsep] (prediction dark) at (group c3r1.above north -| tlight.north);
	
	\begin{axis}[%
		name = dark plot,
		anchor = above north west,
		at = {(prediction dark)},
		xshift = \plotylabelwidth,
		width = \templength,
		axis limits from table = {rawData/PEVdouble_prediction_rbcS-E9_dark_axes.tsv},
		enlargelimits = .05,
		ylabel = \textbf{measurement}:\\$\log_2$(enhancer strength),
		zero line,
		show diagonal,
		title = \enhancer{rbcS-E9} enhancer\\\segment{B} segment,
		title color = rbcS-E9,
		title style = {minimum width = \templength},
		xlabel = \textbf{additive model}:\\$\log_2$(enhancer strength),
		colormap name = viridis,
		colorbar distance,
	]
		
			% scatter plot
			\addplot [
				scatter,
				only marks,
				mark = solido,
				fill opacity = .5,
				point meta = explicit
			] table[x = prediction, y = enrichment, meta = distance] {rawData/PEVdouble_prediction_rbcS-E9_dark_points.tsv};
			
			% correlation
			\stats[stats position = south east]{rawData/PEVdouble_prediction_rbcS-E9_dark}
		
	\end{axis}
	
	\distance{dark plot.south}{dark plot.north}
	
	\node[anchor = south west, rotate = -90, draw = black, fill = dark!20, minimum width = \ydistance, shift = {(-.5\pgflinewidth, -.5\pgflinewidth)}, text depth = 0pt, font = \hphantom{A}] at (dark plot.north east) {\dark};
	
	
	%%% subfigure labels
	\subfiglabel{constructs}
	\subfiglabel{prediction light}
	\subfiglabel{prediction dark}
	
\end{tikzpicture}